<!DOCTYPE html>
<html lang="ko">
<head><meta charset="UTF-8"><title>CSV 편집기</title></head>
<body>
  <button id="load">불러오기</button>
  <button id="save">저장하기</button><br>
  <textarea id="csv" style="width:100%;height:300px"></textarea>

  <script>
    const STATIC_CSV = 'https://ghk71.github.io/LoAEffTab.github.io/data/data.csv'
    const WORKER_API = 'https://loaefftab.vfgtr8746.workers.dev/'

    document.getElementById('load').onclick = async () => {
      try {
        const r = await fetch(STATIC_CSV)
        document.getElementById('csv').value = await r.text()
      } catch (e) { alert('CSV 로드 실패') }
    }

    document.getElementById('save').onclick = async () => {
      const txt = document.getElementById('csv').value
      const b64 = btoa(unescape(encodeURIComponent(txt)))
      const r = await fetch(WORKER_API, {
        method: 'POST',
        mode: 'cors',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({ content: b64 })
      })
      const j = await r.json()
      if (j.commit) alert('업데이트 완료: ' + j.commit.sha)
      else          alert('오류: ' + JSON.stringify(j))
    }
  </script>
</body>
</html>
