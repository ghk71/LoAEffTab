<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë¡œì•„ íš¨ìœ¨í‘œ ì‹œìŠ¤í…œ</title>
  <link rel="stylesheet" href="css/main.css" />
  <link rel="stylesheet" href="css/efficiency.css" />
  <link rel="stylesheet" href="css/character.css" />
  <link rel="stylesheet" href="css/database.css" />
  <link rel="stylesheet" href="css/roster.css" />

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

  <!-- ê°€ê²© ì—…ë°ì´íŠ¸ -->
  <script defer src="js/updatePrice/updatePrice.js"></script>
  <script defer src="js/updatePrice/updateMarketItems.js"></script>
  <script defer src="js/updatePrice/updateGems.js"></script>
  <script defer src="js/updatePrice/updateDealerAcc.js"></script>
  <script defer src="js/updatePrice/updateSupportAcc.js"></script>

  <!-- íš¨ìœ¨í‘œ -->
  <script defer src="js/efficiency/efficiencyTable.js"></script>

  <!-- ìºë¦­í„° ë¡œë“œ -->
  <script defer src="js/loadCharacter/loadCharacter.js"></script>
  <script defer src="js/loadCharacter/updateCharacter.js"></script>
  <script defer src="js/loadCharacter/updateCharacterEquipment.js"></script>
  <script defer src="js/loadCharacter/updateCharacterAccessary.js"></script>
  <script defer src="js/loadCharacter/updateOtherInformation.js"></script>

  <!-- ë””ë²„ê¹… -->
  <script defer src="js/debug/test.js"></script>
</head>
<body>
  <div id="app">
    <h1 class="title">ë¡œì•„ íš¨ìœ¨í‘œ ì‹œìŠ¤í…œ</h1>

    <button onclick="Debugging();">ë””ë²„ê¹…</button>

    <!-- Top Bar -->
    <div class="top-bar">
      <div class="tab active" data-tab="efficiency">íš¨ìœ¨í‘œ</div>
      <div class="tab" data-tab="roster">ë¡œí™ì ìˆ˜</div>
      <div class="tab" data-tab="character">ìºë¦­ì„¤ì •</div>
      <div class="tab" data-tab="database">Database</div>
      <div class="apikey-wrapper">
        <label for="apikey">APIKey</label>
        <input id="apikey" type="text" placeholder="ì—¬ê¸°ì— ì…ë ¥" />
      </div>
    </div>

    <!-- íš¨ìœ¨í‘œ íƒ­ -->
    <div class="tab-content" id="content-efficiency">
      <div id="character-panel">
        <div class="character-search">
          <label for="charName">ìºë¦­í„°ëª…</label>
          <input id="charName" type="text" />
          <button id="charactherBtn" onclick="loadCharacterInformation()">ê²€ìƒ‰</button>
        </div>
        <div class="character-stats" id="characterStats"></div>
      </div>
      <div id="efficiency-table-wrapper"></div>
    </div>

    <!-- ë¡œí™ì ìˆ˜ íƒ­ -->
    <div class="tab-content" id="content-roster" style="display:none;"></div>

    <!-- ìºë¦­ì„¤ì • íƒ­ -->
    <div class="tab-content" id="content-character" style="display:none;"></div>

    <!-- Database íƒ­ -->
    <div class="tab-content" id="content-database" style="display:none;">
      <div class="data-group">
        <div class="group-header">
          <h3 class="group-title">ì‹œì¥ ê°€ê²©</h3>
          <button id="btn-update-all" class="update-btn">Update Price</button>
        </div>
        <div id="top-categories">
          <div class="data-table">
            <h4>ğŸ“¦ ì¬ë£Œ</h4>
            <table id="tbl-materials"></table>
          </div>
          <div class="data-table">
            <h4>ğŸ“œ ë”œëŸ¬ ê°ì¸ì„œ</h4>
            <table id="tbl-dealer-engrave"></table>
          </div>
          <div class="data-table">
            <h4>ğŸ“œ ì„œí¬í„° ê°ì¸ì„œ</h4>
            <table id="tbl-support-engrave"></table>
          </div>
          <div class="data-table">
            <h4>ğŸ’ ë³´ì„</h4>
            <table id="tbl-gems"></table>
          </div>
        </div>
      </div>
      <hr class="market-separator" />
      <div id="bottom-sections">
        <div class="accessory-section">
          <div class="group-header">
            <h3 class="group-title">ë”œëŸ¬ ì•…ì„¸ì„œë¦¬</h3>
            <button id="btn-update-dealer" class="update-btn">ì—…ë°ì´íŠ¸</button>
          </div>
          <div class="data-table">
            <h4>ğŸ”— ëª©ê±¸ì´</h4>
            <table id="tbl-dealer-neck"></table>
          </div>
          <div class="data-table">
            <h4>ğŸ§¿ ê·€ê±¸ì´</h4>
            <table id="tbl-dealer-ear"></table>
          </div>
          <div class="data-table">
            <h4>ğŸ’ ë°˜ì§€</h4>
            <table id="tbl-dealer-ring"></table>
          </div>
        </div>
        <div class="accessory-section">
          <div class="group-header">
            <h3 class="group-title">ì„œí¬í„° ì•…ì„¸ì„œë¦¬</h3>
            <button id="btn-update-support" class="update-btn">ì—…ë°ì´íŠ¸</button>
          </div>
          <div class="data-table">
            <h4>ğŸ”— ëª©ê±¸ì´</h4>
            <table id="tbl-support-neck"></table>
          </div>
          <div class="data-table">
            <h4>ğŸ§¿ ê·€ê±¸ì´</h4>
            <table id="tbl-support-ear"></table>
          </div>
          <div class="data-table">
            <h4>ğŸ’ ë°˜ì§€</h4>
            <table id="tbl-support-ring"></table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // íƒ­ ì „í™˜
    const tabs = document.querySelectorAll('.tab');
    const contents = document.querySelectorAll('.tab-content');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.style.display = 'none');
        tab.classList.add('active');
        document.getElementById(`content-${tab.dataset.tab}`).style.display = 'flex';
      });
    });
    // APIKey ì €ì¥
    const apikeyInput = document.getElementById('apikey');
    apikeyInput.value = localStorage.getItem('supabase_apikey') || '';
    apikeyInput.addEventListener('input', () =>
      localStorage.setItem('supabase_apikey', apikeyInput.value)
    );

    document.getElementById('charName')
    .addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        loadCharacterInformation();
      }
    });
  </script>
</body>
</html>
